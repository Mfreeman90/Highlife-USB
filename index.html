<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Crack - OS Terminal XL</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600;900&display=swap');
        
        body { 
            margin: 0; background-color: #3e166b; color: white; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; height: 100vh; overflow: hidden;
            background-image: radial-gradient(circle, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* Desktop Icons */
        .my-pc { position: absolute; top: 40px; left: 40px; display: flex; flex-direction: column; align-items: center; cursor: pointer; z-index: 5; }
        .pc-icon { width: 55px; height: 65px; background: linear-gradient(to bottom, #7db9e8 0%, #1e5799 100%); border: 2px solid #ffffff; border-radius: 4px; display: flex; justify-content: center; align-items: center; font-size: 1.8rem; }
        .pc-text { margin-top: 8px; font-weight: bold; text-shadow: 2px 2px 4px black; text-align: center; font-size: 0.9rem; }

        /* RICK ROLL OVERLAY */
        #rick-overlay {
            position: fixed; inset: 0; background: black; z-index: 2000;
            display: none; flex-direction: column; justify-content: center; align-items: center;
        }

        .power-off { position: absolute; top: 40px; right: 40px; display: flex; flex-direction: column; align-items: center; cursor: pointer; z-index: 5; }
        .power-circle { width: 70px; height: 70px; background: #222; border: 4px solid #ff4444; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 20px rgba(255, 68, 68, 0.4); }
        .power-symbol { font-size: 2.5rem; color: #ff4444; font-weight: bold; }

        /* Window Styling */
        .os-window { 
            background: #c0c0c0; border: 3px solid #ffffff; border-right-color: #808080; border-bottom-color: #808080;
            box-shadow: 15px 15px 40px rgba(0,0,0,0.6); width: 1150px; position: relative; z-index: 10;
        }
        .os-title-bar { background: linear-gradient(90deg, #000080, #1084d0); padding: 6px 10px; display: flex; justify-content: space-between; align-items: center; color: white; font-weight: bold; font-size: 1rem; }
        .os-controls { display: flex; gap: 4px; }
        .os-btn { width: 22px; height: 22px; background: #c0c0c0; border: 1px solid #ffffff; border-right-color: #404040; border-bottom-color: #404040; color: black; font-size: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-family: sans-serif; font-weight: bold; }

        .window-content { background-color: #050505; padding: 25px; }
        .header { border-bottom: 2px solid #f7931e; padding-bottom: 15px; text-align: center; margin-bottom: 25px;}
        .header-title { color: #f7931e; font-size: 3.5rem; font-family: 'Orbitron'; font-weight: 900; margin: 0; letter-spacing: 6px; }
        .sub-header { color: #fdf5a2; font-size: 1rem; font-family: 'Orbitron'; }
        .mateo-note { color: #ff00ff; font-weight: bold; font-size: 1.2rem; margin-top: 10px; text-shadow: 0 0 5px #ff00ff; }

        /* Game Viewport */
        .game-viewport { position: relative; height: 725px; width: 1030px; margin: 0 auto; border: 3px solid #ff0000; background-color: #000; overflow: hidden; }
        .target-line { position: absolute; width: 100%; height: 35px; background: #ff0000; top: 50%; transform: translateY(-50%); z-index: 1; box-shadow: 0 0 15px rgba(255, 0, 0, 0.6); }
        .bars-container { display: flex; justify-content: center; align-items: center; height: 100%; gap: 46px; position: relative; z-index: 10; }
        
        .part { background-color: white; width: 46px; height: 130px; }
        .spacer { height: 40px; background: transparent; width: 100%; } 
        .active .part { outline: 4px solid #fdf5a2; box-shadow: 0 0 15px #fdf5a2; }

        .win-message, .fail-message { position: absolute; top: 50%; left: 50%; transform: translate(-50% , -50%); z-index: 100; background: rgba(0,0,0,0.95); padding: 40px; text-align: center; width: 80%; display: flex; flex-direction: column; align-items: center; gap: 15px; font-family: 'Orbitron'; }
        .win-message { color: #00ff00; border: 4px solid #00ff00; }
        .fail-message { color: #ff0000; border: 4px solid #ff0000; }
        
        .final-time { font-size: 1.5rem; color: #fff; margin-bottom: 10px; }
        .action-btn { color: black; border: none; padding: 12px 40px; font-family: 'Orbitron'; font-size: 1.8rem; cursor: pointer; font-weight: 900; border-radius: 4px; }
        .win-btn { background: #00ff00; }
        .fail-btn { background: #ff0000; }
    </style>
</head>
<body>

    <div id="rick-overlay">
        <h1 style="font-family: Orbitron; color: #ff4444; margin-bottom: 20px;">SYSTEM OVERLOAD</h1>
        <div id="video-container"></div>
        <button class="action-btn fail-btn" style="margin-top: 20px;" onclick="stopRickRoll()">REBOOT SYSTEM</button>
    </div>

    <script>
        function startRickRoll() {
            const container = document.getElementById('video-container');
            // Auto-playing Rick Roll
            container.innerHTML = '<iframe width="854" height="480" src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&controls=0" frameborder="0" allow="autoplay; encrypted-media"></iframe>';
            document.getElementById('rick-overlay').style.display = 'flex';
        }
        function stopRickRoll() {
            document.getElementById('video-container').innerHTML = '';
            document.getElementById('rick-overlay').style.display = 'none';
        }
    </script>

    <div class="my-pc" onclick="alert('Drive C:/ is locked.')">
        <div class="pc-icon">üíΩ</div>
        <div class="pc-text">My Computer</div>
    </div>

    <div class="power-off" onclick="startRickRoll()">
        <div class="power-circle"><span class="power-symbol">‚èª</span></div>
        <div class="power-text" style="color:#ccc; font-size:0.8rem; font-weight:bold; margin-top:8px;">Power</div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [activeIndex, setActiveIndex] = useState(0);
            const [won, setWon] = useState(false);
            const [failed, setFailed] = useState(false);
            const [startTime, setStartTime] = useState(null);
            const [finalTime, setFinalTime] = useState(null);
            const [bestTime, setBestTime] = useState(localStorage.getItem('dataCrackBest') || null);
            
            const bars = [0, 1, 2, 3, 4, 5, 6]; 
            const refs = useRef(bars.map(() => React.createRef()));
            const animations = useRef([]);
            const audioCtx = useRef(null);

            const playHitSound = () => {
                if (!audioCtx.current) audioCtx.current = new (window.AudioContext || window.webkitAudioContext)();
                if (audioCtx.current.state === 'suspended') audioCtx.current.resume();
                const osc = audioCtx.current.createOscillator();
                const gain = audioCtx.current.createGain();
                osc.type = 'square';
                osc.frequency.setValueAtTime(800, audioCtx.current.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.current.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.current.currentTime + 0.1);
                osc.connect(gain);
                gain.connect(audioCtx.current.destination);
                osc.start();
                osc.stop(audioCtx.current.currentTime + 0.1);
            };

            const initGame = () => {
                if (!audioCtx.current) audioCtx.current = new (window.AudioContext || window.webkitAudioContext)();
                animations.current.forEach(anim => anim && anim.pause());
                animations.current = bars.map((i) => {
                    let speed = 750 - (i * 90);
                    if (i === 5) speed = 350; if (i === 6) speed = 280; 
                    return anime({
                        targets: `#col-${i}`, translateY: [-200, 200], duration: speed,
                        direction: 'alternate', loop: true, easing: 'easeInOutSine', autoplay: true
                    });
                });
            };

            useEffect(() => { initGame(); }, []);

            const handleInteraction = () => {
                if (won || failed) return;
                if (activeIndex === 0 && !startTime) setStartTime(Date.now());
                const targetRect = document.querySelector('.target-line').getBoundingClientRect();
                const spacerRect = refs.current[activeIndex].current.getBoundingClientRect();
                const isHit = Math.abs((spacerRect.top + spacerRect.height/2) - (targetRect.top + targetRect.height/2)) < 25;

                if (isHit) {
                    playHitSound();
                    animations.current[activeIndex].pause();
                    anime({ targets: `#col-${activeIndex}`, translateY: 0, duration: 40 });
                    if (activeIndex === 6) {
                        const timeTaken = ((Date.now() - startTime) / 1000).toFixed(2);
                        setFinalTime(timeTaken);
                        if (!bestTime || parseFloat(timeTaken) < parseFloat(bestTime)) {
                            localStorage.setItem('dataCrackBest', timeTaken);
                            setBestTime(timeTaken);
                        }
                        setWon(true);
                    } else {
                        setActiveIndex(activeIndex + 1);
                    }
                } else {
                    if (activeIndex === 0) {
                        setFailed(true);
                        animations.current.forEach(a => a.pause());
                    } else {
                        animations.current[activeIndex - 1].play();
                        setActiveIndex(activeIndex - 1);
                    }
                }
            };

            const resetGame = (e) => {
                e.stopPropagation();
                setWon(false); setFailed(false); setActiveIndex(0); setStartTime(null); setFinalTime(null);
                bars.forEach(i => anime({ targets: `#col-${i}`, translateY: 0, duration: 0 }));
                setTimeout(initGame, 50);
            };

            useEffect(() => {
                window.addEventListener('mousedown', handleInteraction);
                return () => window.removeEventListener('mousedown', handleInteraction);
            }, [activeIndex, won, failed, startTime]);

            return (
                <div style={{display:'flex', justifyContent:'center', alignItems:'center', width:'100vw', height:'100vh'}}>
                    <div className="os-window">
                        <div className="os-title-bar">
                            <span>C:\WINDOWS\System32\datacrack.exe</span>
                            <div className="os-controls">
                                <div className="os-btn">_</div>
                                <div className="os-btn">‚ñ°</div>
                                <div className="os-btn" onClick={() => alert('Access Denied')}>X</div>
                            </div>
                        </div>
                        <div className="window-content">
                            <div className="header">
                                <h1 className="header-title">DATA CRACK</h1>
                                <div className="sub-header">BEST RECORD: {bestTime ? `${bestTime} SECONDS` : 'NOT SET'}</div>
                                <div className="mateo-note">Mateo Strap loves you!</div>
                            </div>
                            <div className="game-viewport">
                                <div className="target-line" />
                                <div className="bars-container">
                                    {bars.map((i) => (
                                        <div key={i} id={`col-${i}`} className={`slider-column ${i === activeIndex ? 'active' : ''}`}>
                                            <div className="part" /><div className="spacer" ref={refs.current[i]} /><div className="part" />
                                        </div>
                                    ))}
                                </div>
                                {won && (
                                    <div className="win-message">
                                        <h2 style={{fontSize:'4rem', margin:0}}>DECRYPTED</h2>
                                        <div className="final-time">TIME: {finalTime} SECONDS</div>
                                        <button className="action-btn win-btn" onClick={resetGame}>RUN AGAIN</button>
                                    </div>
                                )}
                                {failed && (
                                    <div className="fail-message">
                                        <h2 style={{fontSize:'4rem', margin:0}}>LOCKED OUT</h2>
                                        <button className="action-btn fail-btn" onClick={resetGame}>RETRAIN</button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
