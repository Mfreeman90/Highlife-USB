<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Crack - OS Terminal XL</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600;900&display=swap');
        
        body { 
            margin: 0; background-color: #3e166b; color: white; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; height: 100vh; overflow: hidden;
            background-image: radial-gradient(circle, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            user-select: none;
        }

        /* Icons */
        .my-pc { position: absolute; top: 20px; left: 20px; display: flex; flex-direction: column; align-items: center; cursor: pointer; z-index: 5; }
        .pc-icon { width: 50px; height: 55px; background: linear-gradient(to bottom, #7db9e8 0%, #1e5799 100%); border: 2px solid #ffffff; border-radius: 4px; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; }
        .pc-text { margin-top: 5px; font-weight: bold; text-shadow: 2px 2px 4px black; font-size: 0.8rem; }

        .power-off { position: absolute; top: 20px; right: 20px; display: flex; flex-direction: column; align-items: center; cursor: pointer; z-index: 5; }
        .power-circle { width: 50px; height: 50px; background: #222; border: 3px solid #ff4444; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 15px rgba(255, 68, 68, 0.4); }
        .power-symbol { font-size: 1.8rem; color: #ff4444; font-weight: bold; }

        /* Windows UI */
        .os-window { background: #c0c0c0; border: 3px solid #ffffff; border-right-color: #808080; border-bottom-color: #808080; box-shadow: 10px 10px 30px rgba(0,0,0,0.5); position: relative; pointer-events: auto; }
        .os-title-bar { background: linear-gradient(90deg, #000080, #1084d0); padding: 4px 8px; display: flex; justify-content: space-between; align-items: center; color: white; font-weight: bold; font-size: 0.9rem; }
        .os-controls { display: flex; gap: 3px; }
        .os-btn { width: 18px; height: 18px; background: #c0c0c0; border: 1px solid #ffffff; border-right-color: #404040; border-bottom-color: #404040; color: black; font-size: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; }

        .window-content { background-color: #050505; padding: 15px; }
        .header-title { color: #f7931e; font-size: 2.5rem; font-family: 'Orbitron'; font-weight: 900; margin: 0; text-align: center; letter-spacing: 4px; border-bottom: 2px solid #f7931e; padding-bottom: 10px; margin-bottom: 15px; }

        /* Layout */
        .main-layout { display: flex; gap: 20px; justify-content: center; align-items: flex-start; padding: 50px; }

        /* Game Viewport */
        .game-viewport { position: relative; height: 600px; width: 850px; background-color: #000; overflow: hidden; border: 2px solid #ff0000; }
        .target-line { position: absolute; width: 100%; height: 35px; background: #ff0000; top: 50%; transform: translateY(-50%); z-index: 1; box-shadow: 0 0 15px rgba(255, 0, 0, 0.6); }
        .bars-container { display: flex; justify-content: center; align-items: center; height: 100%; gap: 35px; position: relative; z-index: 10; }
        .part { background-color: white; width: 38px; height: 110px; }
        .spacer { height: 40px; width: 100%; } 
        .active .part { outline: 3px solid #fdf5a2; box-shadow: 0 0 15px #fdf5a2; }

        /* Sidebar Leaderboard */
        .sidebar-window { width: 280px; height: 658px; }
        .lb-list { color: #00ff00; font-family: 'Orbitron'; list-style: none; padding: 0; margin: 0; }
        .lb-entry { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #333; font-size: 0.9rem; }
        .lb-rank { color: #f7931e; width: 30px; }
        .lb-name { flex-grow: 1; text-align: left; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; padding-right: 5px; }

        /* Win/Fail Modals */
        .modal { position: absolute; top: 50%; left: 50%; transform: translate(-50% , -50%); z-index: 100; background: rgba(0,0,0,0.95); padding: 30px; text-align: center; width: 80%; font-family: 'Orbitron'; border: 4px solid #00ff00; }
        .name-input { background: #111; border: 2px solid #00ff00; color: #00ff00; padding: 10px; font-family: 'Orbitron'; text-align: center; font-size: 1.2rem; margin: 15px 0; width: 250px; outline: none; }
        .action-btn { color: black; border: none; padding: 10px 30px; font-family: 'Orbitron'; font-size: 1.5rem; cursor: pointer; font-weight: 900; }
        
        #rick-overlay { position: fixed; inset: 0; background: black; z-index: 2000; display: none; flex-direction: column; justify-content: center; align-items: center; }
    </style>
</head>
<body>

    <div id="rick-overlay">
        <h1 style="font-family: Orbitron; color: #ff4444; margin-bottom: 20px;">SYSTEM OVERLOAD</h1>
        <div id="video-container"></div>
        <button class="action-btn" style="background:#ff0000; margin-top:20px;" onclick="location.reload()">REBOOT</button>
    </div>

    <div class="my-pc" onclick="alert('Drive C:/ is locked.')">
        <div class="pc-icon">üíΩ</div>
        <div class="pc-text">My Computer</div>
    </div>

    <div class="power-off" onclick="document.getElementById('rick-overlay').style.display='flex'; document.getElementById('video-container').innerHTML='<iframe width=854 height=480 src=https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&controls=0 frameborder=0 allow=autoplay></iframe>'">
        <div class="power-circle"><span class="power-symbol">‚èª</span></div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [activeIndex, setActiveIndex] = useState(0);
            const [gameState, setGameState] = useState('playing'); // playing, won, failed
            const [startTime, setStartTime] = useState(null);
            const [finalTime, setFinalTime] = useState(0);
            const [username, setUsername] = useState('');
            const [leaderboard, setLeaderboard] = useState(JSON.parse(localStorage.getItem('dataCrackLB_XL')) || []);
            
            const bars = [0, 1, 2, 3, 4, 5, 6]; 
            const refs = useRef(bars.map(() => React.createRef()));
            const animations = useRef([]);

            const initGame = () => {
                animations.current.forEach(anim => anim && anim.pause());
                animations.current = bars.map((i) => {
                    let speed = 750 - (i * 90);
                    if (i === 5) speed = 350; if (i === 6) speed = 280; 
                    return anime({
                        targets: `#col-${i}`, translateY: [-180, 180], duration: speed,
                        direction: 'alternate', loop: true, easing: 'easeInOutSine', autoplay: true
                    });
                });
            };

            useEffect(() => { initGame(); }, []);

            const handleSaveScore = () => {
                const name = username.trim() || 'ANON_HACKER';
                const newLB = [...leaderboard, { name, time: parseFloat(finalTime) }]
                    .sort((a, b) => a.time - b.time)
                    .slice(0, 10);
                setLeaderboard(newLB);
                localStorage.setItem('dataCrackLB_XL', JSON.stringify(newLB));
                resetGame();
            };

            const handleInteraction = (e) => {
                if (e.target.closest('.os-btn') || e.target.closest('input')) return;
                if (gameState !== 'playing') return;

                if (activeIndex === 0 && !startTime) setStartTime(Date.now());
                const targetRect = document.querySelector('.target-line').getBoundingClientRect();
                const spacerRect = refs.current[activeIndex].current.getBoundingClientRect();
                
                // HIT AREA: 35px
                const isHit = Math.abs((spacerRect.top + spacerRect.height/2) - (targetRect.top + targetRect.height/2)) < 35;

                if (isHit) {
                    animations.current[activeIndex].pause();
                    anime({ targets: `#col-${activeIndex}`, translateY: 0, duration: 40 });
                    if (activeIndex === 6) {
                        setFinalTime(((Date.now() - startTime) / 1000).toFixed(2));
                        setGameState('won');
                    } else {
                        setActiveIndex(activeIndex + 1);
                    }
                } else {
                    if (activeIndex === 0) {
                        setGameState('failed');
                        animations.current.forEach(a => a.pause());
                    } else {
                        animations.current[activeIndex - 1].play();
                        setActiveIndex(activeIndex - 1);
                    }
                }
            };

            const resetGame = () => {
                setGameState('playing'); setActiveIndex(0); setStartTime(null); setUsername('');
                bars.forEach(i => anime({ targets: `#col-${i}`, translateY: 0, duration: 0 }));
                setTimeout(initGame, 50);
            };

            useEffect(() => {
                window.addEventListener('mousedown', handleInteraction);
                return () => window.removeEventListener('mousedown', handleInteraction);
            }, [activeIndex, gameState, startTime]);

            return (
                <div className="main-layout">
                    {/* Main Game Window */}
                    <div className="os-window">
                        <div className="os-title-bar">
                            <span>C:\WINDOWS\System32\datacrack.exe</span>
                            <div className="os-controls">
                                <div className="os-btn">_</div><div className="os-btn">‚ñ°</div><div className="os-btn">X</div>
                            </div>
                        </div>
                        <div className="window-content">
                            <h1 className="header-title">DATA CRACK</h1>
                            <div className="game-viewport">
                                <div className="target-line" />
                                <div className="bars-container">
                                    {bars.map((i) => (
                                        <div key={i} id={`col-${i}`} className={i === activeIndex ? 'active' : ''}>
                                            <div className="part" /><div className="spacer" ref={refs.current[i]} /><div className="part" />
                                        </div>
                                    ))}
                                </div>
                                
                                {gameState === 'won' && (
                                    <div className="modal">
                                        <h2 style={{fontSize:'2.5rem', margin:0, color: '#00ff00'}}>SUCCESS</h2>
                                        <div style={{fontSize: '1.2rem', margin: '10px 0'}}>DECRYPTED IN {finalTime}s</div>
                                        <input 
                                            className="name-input" 
                                            placeholder="ENTER INITIALS" 
                                            maxLength="12"
                                            value={username}
                                            onChange={(e) => setUsername(e.target.value.toUpperCase())}
                                            autoFocus
                                        />
                                        <br/>
                                        <button className="action-btn" style={{background:'#00ff00'}} onClick={handleSaveScore}>SUBMIT LOG</button>
                                    </div>
                                )}

                                {gameState === 'failed' && (
                                    <div className="modal" style={{borderColor: '#ff0000'}}>
                                        <h2 style={{fontSize:'2.5rem', margin:0, color: '#ff0000'}}>LOCKED OUT</h2>
                                        <button className="action-btn" style={{background:'#ff0000', marginTop: '20px'}} onClick={resetGame}>RETRY</button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* Leaderboard Sidebar Window */}
                    <div className="os-window sidebar-window">
                        <div className="os-title-bar">
                            <span>GLOBAL_RECORDS.LOG</span>
                            <div className="os-controls">
                                <div className="os-btn">X</div>
                            </div>
                        </div>
                        <div className="window-content" style={{height: 'calc(100% - 30px)', overflowY: 'auto'}}>
                            <div style={{color: '#fdf5a2', fontSize: '0.8rem', marginBottom: '10px', textAlign: 'center'}}>TOP HACKER PROFILES</div>
                            <div className="lb-list">
                                {leaderboard.map((entry, i) => (
                                    <div key={i} className="lb-entry">
                                        <span className="lb-rank">{i + 1}.</span>
                                        <span className="lb-name">{entry.name}</span>
                                        <span className="lb-time">{entry.time}s</span>
                                    </div>
                                ))}
                                {leaderboard.length === 0 && <div style={{textAlign:'center', opacity: 0.5}}>NO DATA FOUND</div>}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
